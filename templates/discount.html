{% extends "index.html" %}

{% block title %}Discount | Ahmad Gas Center{% endblock  %}

{% block content  %}
<div class='p-2'>
    <h2 class="text-3xl sm:text-4xl md:text-6xl font-mono font-bold text-center text-purple-800 my-8 uppercase tracking-wide border-b-2 border-purple-400 pb-2">
  SPECIAL <span class="font-bold text-green-800">DISCOUNTS</span> OFFERS
</h2>
  <div
    class="mt-1 grid grid-cols-1 gap-x-6 gap-y-10 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8"
  >
  
    {% for i in discount %}
    <div
      class="w-full bg-white border border-gray-200 rounded-xl shadow-sm dark:bg-gray-800 dark:border-gray-700"
    >
      <div
        class="h-80 overflow-hidden flex items-center justify-center my-4"
      >
        <a href="/media/{{i.image}}" class="items-center">
          <img
            class="w-full h-full object-cover p-4 hover:opacity-75"
            src="/media/{{i.image}}"
            alt="product image"
          />
        </a>
      </div>

      <div class="px-5 pb-5">
         <h2 class="font-bold text-xl">{{i.product_name}}</h2>
          <div class="sm:h-18 overflow-hidden mb-3">
    
        <p class="text-md tracking-tight text-gray-900 dark:text-white line-clamp-3">
          {{ i.desc|slice:":76" }}...
          <a href="{% url 'products' 'discount' i.id %}" class="text-blue-600 hover:underline"> See more</a>
        </p>
        
      
    </div>
        <div class="flex items-center mt-2.5 mb-1.5">
          <div
            class="star-wrapper flex items-center space-x-1 rtl:space-x-reverse"
          >
            {% for _ in "12345" %}
            <svg
              class="w-4 h-4 text-yellow-300"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
              viewBox="0 0 22 20"
            >
              <path
                d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z"
              />
            </svg>
            {% endfor %}
          </div>
          <span
            class="rating-value bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-sm ms-3"
          >
            {{ i.rating }}
          </span>
        </div>
        <div class="flex flex-row justify-between">
        <div class="relative">
  <span class="absolute -bottom-5 text-[23px] px-2 font-bold
         text-red-900 
        before:content-[''] before:absolute before:top-1/2 before:left-0 before:w-full before:h-[2px] before:bg-current before:z-10">
    Rs.{{i.orgprice}}
  </span>
        </div>

  <span class=" text-green-600 font-bold px-6 text-[20px]"> {{i.dist}}% OFF
  </span>
</div>
        <div class="flex items-center justify-between">
          <span class="text-[27px] items-center font-bold text-green-900"
            >Rs.{{i.price}}</span
          >
         <button type="button" class="whatsapp-btn cursor-pointer mt-2 relative inline-flex items-center justify-center p-0.5 mb-2 me-2 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-pink-500 to-orange-400 group-hover:from-pink-500 group-hover:to-orange-400 hover:text-white dark:text-white focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800"
              data-product="{{ i.product_name }}"
  data-price="{{ i.price }}"
  >
  <span class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white dark:bg-gray-900 rounded-md group-hover:bg-transparent group-hover:dark:bg-transparent">
   Shop Now
  </span>
</button>

             </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

{% endblock  %}
 {% block javascript %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const productCards = document.querySelectorAll(".star-wrapper");

    productCards.forEach(function (starWrapper) {
      const ratingText = starWrapper.nextElementSibling?.textContent?.trim();
      const rating = parseFloat(ratingText);

      const stars = starWrapper.querySelectorAll("svg");

      stars.forEach((star, index) => {
        star.classList.remove("text-yellow-300", "text-gray-200");
        if (rating >= index + 1) {
          star.classList.add("text-yellow-300");
        } else {
          star.classList.add("text-gray-200");
        }
      });
    });
  });
{% comment %} shop cart Logic {% endcomment %}

 console.log("working...");
if(localStorage.getItem('cart')== null){
  var cart = {};
}
else{
  cart=JSON.parse(localStorage.getItem('cart'));
}
$('.cart').click(function(){
  console.log("clicked");
  var idstr = this.id.toString();
  console.log(idstr);
  if(cart[idstr]!= undefined){
    cart[idstr]+=1;
  }
  else{
    cart[idstr]=1;
  }
  console.log(cart);
  localStorage.setItem('cart',JSON.stringify(cart));
});

{% comment %} whatsapp {% endcomment %}

  $(document).ready(function () {
    $(".whatsapp-btn").click(function () {
      var product = $(this).data("product");
      var price = $(this).data("price");

      var message = `Asslam-o-Alaikum! I want to buy this product:\n\nName: *${product}*\nPrice: Rs. *${price}*\n\nPlease confirm availability.`;
      var phone = "923323550131"; // üîÅ Replace with your WhatsApp number (without +)

      var url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(url, "_blank");
    });
  });


</script>

<script src="https://unpkg.com/flowbite@1.6.5/dist/flowbite.min.js"></script>


{% endblock %} 
